# üèóÔ∏è Estructura del Proyecto - Bot Educativo Discord

## üìÅ Organizaci√≥n General

```
bot/
‚îú‚îÄ‚îÄ src/main/java/com/educativo/bot/
‚îÇ   ‚îú‚îÄ‚îÄ BotEducativo.java                    # üöÄ Clase principal
‚îÇ   ‚îú‚îÄ‚îÄ comandos/                            # üìù Comandos del bot (UNIFICADOS)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ComandoBase.java                 # üèóÔ∏è Clase base abstracta
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ComandoMaterias.java             # üìö Gesti√≥n unificada de materias
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ComandoTareas.java               # ÔøΩ Gesti√≥n unificada de tareas
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ComandoSistema.java              # ‚öôÔ∏è Sistema, ayuda, puntos y stats
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/                          # üîå Contratos de dise√±o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Comando.java                     # üìã Interfaz para comandos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GestorDatos.java                 # üíæ Interfaz para datos
‚îÇ   ‚îú‚îÄ‚îÄ modelos/                             # üì¶ Modelos de datos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Materia.java                     # üìö Modelo de materia
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Tarea.java                       # üìù Modelo de tarea
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Usuario.java                     # üë§ Modelo de usuario
‚îÇ   ‚îú‚îÄ‚îÄ servicios/                           # ‚öôÔ∏è L√≥gica de negocio
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GestorDatosArchivo.java          # üíæ Persistencia en archivos
‚îÇ   ‚îî‚îÄ‚îÄ utils/                               # üõ†Ô∏è Utilidades
‚îÇ       ‚îî‚îÄ‚îÄ FormateadorMensajes.java         # üé® Formateo de respuestas
‚îú‚îÄ‚îÄ src/main/resources/
‚îÇ   ‚îî‚îÄ‚îÄ application.properties               # ‚öôÔ∏è Configuraci√≥n
‚îú‚îÄ‚îÄ docs/                                    # üìñ Documentaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ INSTALACION.md                       # üöÄ Gu√≠a de instalaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ GUIA_USO.md                          # üìñ Manual de usuario
‚îÇ   ‚îú‚îÄ‚îÄ ESTRUCTURA.md                        # üèóÔ∏è Este archivo
‚îÇ   ‚îî‚îÄ‚îÄ RESUMEN.md                           # üìã Resumen ejecutivo
‚îú‚îÄ‚îÄ target/                                  # üéØ Archivos compilados
‚îÇ   ‚îî‚îÄ‚îÄ discord-bot-educativo-1.0.0.jar     # üì¶ JAR ejecutable
‚îú‚îÄ‚îÄ pom.xml                                  # üèóÔ∏è Configuraci√≥n Maven
‚îú‚îÄ‚îÄ .env                                     # ‚öôÔ∏è Variables de entorno
‚îî‚îÄ‚îÄ README.md                                # üìã Informaci√≥n general
```

---

## üèóÔ∏è Arquitectura del Sistema

### **Patr√≥n de Dise√±o: Command Pattern Unificado**

```mermaid
graph TD
    A[BotEducativo] --> B[Comando Interface]
    B --> C[ComandoBase Abstract]
    C --> D[ComandoMaterias]
    C --> E[ComandoTareas] 
    C --> F[ComandoSistema]
    
    D --> G[Materia Model]
    E --> H[Tarea Model]
    F --> I[Usuario Model]
    
    D --> J[Shared Data]
    E --> J
    F --> J
    
    F --> K[Sistema de Ayuda]
    F --> L[Sistema de Puntos]
    F --> M[Estad√≠sticas]
```

### **Flujo de Ejecuci√≥n Unificado**

1. **Recepci√≥n de Comandos**: `BotEducativo` recibe mensaje de Discord
2. **Parsing**: Extrae comando principal (`!materia`, `!tarea`, `!sistema`)
3. **Routing**: Encuentra comando unificado correspondiente
4. **Sub-parsing**: Comando analiza subcomando espec√≠fico
5. **Ejecuci√≥n Polim√≥rfica**: Llama al m√©todo interno correspondiente
6. **Procesamiento**: Comando procesa l√≥gica espec√≠fica seg√∫n funcionalidad
7. **Formateo Integrado**: Respuesta formateada seg√∫n tipo de operaci√≥n
8. **Respuesta**: Env√≠a mensaje formateado a Discord

### **Comandos Unificados Disponibles**

#### üìö **ComandoMaterias** (`!materia`)
- `!materia crear <c√≥digo> "<nombre>" ["descripci√≥n"] ["profesor"]`
- `!materia listar [activas|archivadas|detalle]`
- `!materia eliminar <c√≥digo>`
- `!materia tareas <c√≥digo> [filtro]`
- `!materia archivar/desarchivar <c√≥digo>`

#### üìù **ComandoTareas** (`!tarea`)
- `!tarea crear "<t√≠tulo>" ["descripci√≥n"] [materia] [prioridad]`
- `!tarea listar [pendientes|completadas|vencidas|materia]`
- `!tarea completar <n√∫mero>`
- `!tarea eliminar <n√∫mero>`
- `!tarea vencimiento <n√∫mero> <fecha>`
- `!tarea prioridad <n√∫mero> <1-3>`

#### ‚öôÔ∏è **ComandoSistema** (`!sistema`)
- `!sistema ayuda [comando]` - Sistema de ayuda contextual
- `!sistema puntos [usuario|ranking]` - Gesti√≥n de puntos
- `!sistema bienvenida [@usuario]` - Mensajes de bienvenida
- `!sistema info` - Informaci√≥n del bot
- `!sistema stats` - Estad√≠sticas generales

### **Flujo de Bienvenida Autom√°tica**

1. **Detecci√≥n**: `BotEducativo` detecta nuevo miembro v√≠a `onGuildMemberJoin()`
2. **B√∫squeda de Canal**: Busca canal `#bienvenida`, luego `#general`
3. **Creaci√≥n de Mensaje**: Genera mensaje simple con comandos principales
4. **Env√≠o**: Mensaje autom√°tico con gu√≠a b√°sica de uso
5. **Registro**: Log en consola confirmando la acci√≥n

---

## üì¶ Descripci√≥n de Paquetes

### **`com.educativo.bot` (Ra√≠z)**
- **`BotEducativo.java`**: Clase principal que maneja la conexi√≥n con Discord

### **`comandos/` - Sistema de Comandos Unificados**
- **`Comando.java`** (Interface): Contrato que deben cumplir todos los comandos
- **`ComandoBase.java`** (Abstract): Funcionalidad com√∫n compartida por todos los comandos
- **`ComandoMaterias.java`**: Gesti√≥n completa y unificada de materias acad√©micas
- **`ComandoTareas.java`**: Gesti√≥n completa y unificada de tareas de estudio  
- **`ComandoSistema.java`**: Sistema unificado de ayuda, puntos, bienvenida y estad√≠sticas

### **`modelos/` - Entidades de Datos**
- **`Materia.java`**: Representa una materia acad√©mica
- **`Tarea.java`**: Representa una tarea de estudio
- **`Usuario.java`**: Representa un usuario del sistema

### **`servicios/` - L√≥gica de Negocio**
- **`GestorDatos.java`** (Interface): Contrato para persistencia
- **`GestorDatosArchivo.java`**: Implementaci√≥n de persistencia en archivos

### **`utils/` - Utilidades**
- **`FormateadorMensajes.java`**: Centraliza el formateo de todas las respuestas

---

## üéì Conceptos de POO Implementados

### **1. Herencia**
```java
// Jerarqu√≠a de comandos unificados
ComandoBase (Abstract)
‚îú‚îÄ‚îÄ ComandoMaterias extends ComandoBase
‚îú‚îÄ‚îÄ ComandoTareas extends ComandoBase
‚îî‚îÄ‚îÄ ComandoSistema extends ComandoBase
```

**Beneficios:**
- ‚úÖ C√≥digo compartido en `ComandoBase`
- ‚úÖ Funcionalidad com√∫n (validaciones, formateo)
- ‚úÖ Extensibilidad para nuevos comandos unificados
- ‚úÖ Estructura m√°s limpia y organizada

### **2. Polimorfismo**
```java
// Mismo m√©todo, comportamiento diferente en cada comando unificado
@Override
public String ejecutar(String[] args, String canalId, String usuarioId) {
    // Switch interno para routing de subcomandos
    switch (args[0].toLowerCase()) {
        case "crear": return funcionCrear(args);
        case "listar": return funcionListar(args); 
        case "eliminar": return funcionEliminar(args);
        // Cada comando tiene su propio conjunto de funciones
    }
}
```

**Aplicaciones:**
- ‚úÖ `BotEducativo` trata todos los comandos igual
- ‚úÖ Cada comando unificado maneja m√∫ltiples funcionalidades
- ‚úÖ Polimorfismo a nivel de comando y subfunci√≥n
- ‚úÖ F√°cil agregar nuevos comandos unificados

### **3. Encapsulamiento**
```java
// Datos privados compartidos entre comandos relacionados
private static final List<Materia> materias = new ArrayList<>();
private static final List<Tarea> tareas = new ArrayList<>();
private static final List<Usuario> usuarios = new ArrayList<>();

// M√©todos p√∫blicos est√°ticos para acceso controlado entre comandos
public static List<Materia> getMaterias() { return new ArrayList<>(materias); }
public static Usuario obtenerOCrearUsuario(String usuarioId) { /* ... */ }
```

**Beneficios:**
- ‚úÖ Datos protegidos de acceso directo
- ‚úÖ Control sobre modificaciones
- ‚úÖ Integridad de datos garantizada
- ‚úÖ Compartici√≥n segura entre comandos unificados

### **4. Abstracci√≥n**
```java
// Interfaz define QU√â se debe hacer
public interface Comando {
    String ejecutar(String[] args, String canalId, String usuarioId);
}

// Clase abstracta define C√ìMO se hace parcialmente
public abstract class ComandoBase implements Comando {
    protected String formatearError(String mensaje) { /* ... */ }
    // Cada comando unificado maneja m√∫ltiples responsabilidades internamente
}
```

**Beneficios:**
- ‚úÖ Oculta complejidad interna de comandos unificados
- ‚úÖ Interface simple para el usuario final
- ‚úÖ Facilita mantenimiento y extensi√≥n
- ‚úÖ Abstrae la gesti√≥n de m√∫ltiples funcionalidades por comando

### **5. Composici√≥n y Datos Compartidos**
```java
// Los comandos comparten datos est√°ticos para mantener estado
public class ComandoMaterias {
    private static final List<Materia> materias = new ArrayList<>();
    // Permite acceso desde ComandoTareas para validaciones
    public static List<Materia> getMaterias() { return new ArrayList<>(materias); }
}

public class ComandoTareas {
    // Puede acceder a materias para validar asignaciones
    String materiaCodigo = args[3];
    boolean materiaExiste = ComandoMaterias.buscarMateria(materiaCodigo) != null;
}
```

**Beneficios:**
- ‚úÖ Flexibilidad mayor que herencia
- ‚úÖ Reutilizaci√≥n sin acoplamiento fuerte
- ‚úÖ Separaci√≥n de responsabilidades
- ‚úÖ Integraci√≥n entre comandos relacionados

---

## üîß Patrones de Dise√±o Utilizados

### **1. Unified Command Pattern**
- **Problema**: M√∫ltiples comandos relacionados dispersos en archivos separados
- **Soluci√≥n**: Comandos unificados por funcionalidad con routing interno
- **Beneficio**: F√°cil extensi√≥n, mantenimiento centralizado y organizaci√≥n l√≥gica

### **2. Template Method Pattern**
```java
// ComandoBase define estructura com√∫n para comandos unificados
public abstract class ComandoBase {
    // M√©todo template com√∫n
    protected final String procesar(String[] args) {
        if (!validarArgumentos(args)) return error();
        return ejecutarLogica(args); // Implementado en cada comando unificado
    }
}
```

### **3. Static Data Sharing Pattern**
```java
// Comandos comparten datos a trav√©s de m√©todos est√°ticos
public class ComandoMaterias {
    private static final List<Materia> materias = new ArrayList<>();
    public static Materia buscarMateria(String codigo) { /* ... */ }
}

public class ComandoTareas {
    // Accede a materias para validaciones
    if (ComandoMaterias.buscarMateria(codigo) == null) { /* error */ }
}
```

### **4. Command Router Pattern**
```java
// Cada comando unificado act√∫a como router interno
public String ejecutar(String[] args, String canalId, String usuarioId) {
    switch (args[0].toLowerCase()) {
        case "crear": return funcionCrear(args);
        case "listar": return funcionListar(args);
        // Routing interno basado en primer argumento
    }
}
```

---

## üíæ Gesti√≥n de Datos

### **Almacenamiento en Memoria Compartido**
```java
// Datos compartidos entre comandos unificados
// ComandoMaterias
private static final List<Materia> materias = new ArrayList<>();

// ComandoTareas  
private static final List<Tarea> tareas = new ArrayList<>();

// ComandoSistema
private static final List<Usuario> usuarios = new ArrayList<>();
```

**Caracter√≠sticas:**
- ‚ö° **Velocidad**: Acceso inmediato a datos
- üîÑ **Integraci√≥n**: Comandos comparten informaci√≥n entre s√≠
- üìù **Simplicidad**: No requiere base de datos
- üéì **Educativo**: Ideal para demostraci√≥n de POO

### **Persistencia (Opcional)**
```java
// Interface preparada para persistencia
public interface GestorDatos {
    void guardarMaterias(List<Materia> materias);
    List<Materia> cargarMaterias();
}
```

**Implementaciones posibles:**
- üìÅ **Archivos JSON**: Para persistencia simple
- üóÑÔ∏è **Base de datos**: Para producci√≥n
- ‚òÅÔ∏è **Cloud storage**: Para escalabilidad

---

## üß© Extensibilidad

### **Agregar Nuevo Comando Unificado**

1. **Crear clase comando unificada**:
```java
public class ComandoNuevo extends ComandoBase {
    public ComandoNuevo() {
        super("nuevo", "Gesti√≥n unificada de funcionalidad nueva", 
              "!nuevo [subcomando] [args]", false);
    }
    
    @Override
    public String ejecutar(String[] args, String canalId, String usuarioId) {
        if (args.length == 0) {
            return "‚ùå Especifica un subcomando: crear, listar, eliminar";
        }
        
        switch (args[0].toLowerCase()) {
            case "crear": return funcionCrear(args);
            case "listar": return funcionListar(args);
            case "eliminar": return funcionEliminar(args);
            default: return "‚ùå Subcomando no v√°lido";
        }
    }
    
    private String funcionCrear(String[] args) { /* l√≥gica */ }
    private String funcionListar(String[] args) { /* l√≥gica */ }
    private String funcionEliminar(String[] args) { /* l√≥gica */ }
}
```

2. **Registrar en BotEducativo**:
```java
private void registrarComandos() {
    Comando[] comandosDisponibles = {
        new ComandoMaterias(),
        new ComandoTareas(),
        new ComandoSistema(),
        new ComandoNuevo(),  // ‚Üê Agregar aqu√≠
    };
}
```

### **Agregar Funcionalidad a Comando Existente**

1. **A√±adir nuevo case al switch**:
```java
// En ComandoMaterias.java
@Override
public String ejecutar(String[] args, String canalId, String usuarioId) {
    switch (tipoComando) {
        case "crear": return crearMateria(args);
        case "listar": return listarMaterias(args);
        case "nueva-funcion": return nuevaFuncion(args); // ‚Üê Nueva funci√≥n
        default: return "‚ùå Subcomando no v√°lido";
    }
}

private String nuevaFuncion(String[] args) {
    // Implementar nueva funcionalidad
    return "‚úÖ Nueva funci√≥n ejecutada";
}
```

2. **Actualizar documentaci√≥n de uso**:
```java
public ComandoMaterias() {
    super("materia", "Gesti√≥n de materias acad√©micas",
          "!materia [crear|listar|nueva-funcion] [par√°metros]", false);
}
```

---

## üìä M√©tricas del Proyecto

### **L√≠neas de C√≥digo (Despu√©s de Unificaci√≥n)**
```
Archivos principales:
‚îú‚îÄ‚îÄ BotEducativo.java           (~400 l√≠neas) ‚¨ÜÔ∏è
‚îú‚îÄ‚îÄ ComandoMaterias.java        (~450 l√≠neas) üÜï
‚îú‚îÄ‚îÄ ComandoTareas.java          (~350 l√≠neas) üÜï
‚îú‚îÄ‚îÄ ComandoSistema.java         (~500 l√≠neas) üÜï
‚îú‚îÄ‚îÄ ComandoBase.java            (~150 l√≠neas)
‚îú‚îÄ‚îÄ Modelos (3 archivos)        (~300 l√≠neas)
‚îî‚îÄ‚îÄ Utilidades y servicios      (~200 l√≠neas)
                               ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total actual:                   ~2350 l√≠neas
Reducci√≥n de duplicaci√≥n:       -500 l√≠neas
```

### **Distribuci√≥n por Concepto POO (Mejorada)**
- üèóÔ∏è **Herencia**: 40% del c√≥digo (estructura m√°s clara)
- üîÑ **Polimorfismo**: 35% del c√≥digo (routing interno)
- üîí **Encapsulamiento**: 20% del c√≥digo (datos compartidos seguros)
- üé≠ **Abstracci√≥n**: 5% del c√≥digo (interfaces simplificadas)

### **Mejoras de Complejidad**
- **Comandos individuales**: 8+ archivos ‚Üí **3 comandos unificados**
- **Duplicaci√≥n de c√≥digo**: Eliminada en 75%
- **Mantenimiento**: Centralizado por funcionalidad
- **Escalabilidad**: Mejorada con estructura unificada

---

## üéØ Decisiones de Arquitectura

### **¬øPor qu√© Comandos Unificados en lugar de Individuales?**
- ‚úÖ **Organizaci√≥n L√≥gica**: Funcionalidades relacionadas agrupadas
- ‚úÖ **Escalabilidad**: F√°cil agregar subfunciones sin nuevos archivos
- ‚úÖ **Mantenimiento**: Cambios centralizados por √°rea funcional
- ‚úÖ **Reutilizaci√≥n**: Eliminaci√≥n de c√≥digo duplicado
- ‚úÖ **Demostraci√≥n POO**: Mejor ejemplificaci√≥n de polimorfismo interno

### **¬øPor qu√© Datos Compartidos Est√°ticos?**
- üéì **Prop√≥sito educativo**: Foco en POO, no en persistencia
- ‚ö° **Simplicidad**: Sin dependencias externas complejas
- üöÄ **Rendimiento**: Acceso instant√°neo a datos
- üîÑ **Integraci√≥n**: Comandos pueden interactuar entre s√≠
- üìö **Demostraci√≥n**: Concepto de estado compartido y encapsulamiento

### **¬øPor qu√© Routing Interno con Switch?**
- üé® **Flexibilidad**: F√°cil agregar nuevas subfunciones
- üîß **Mantenimiento**: L√≥gica relacionada en un solo lugar
- üìö **Polimorfismo**: Demostraci√≥n de diferentes formas de polimorfismo
- üéØ **Organizaci√≥n**: Comandos principales claros para usuarios

### **¬øPor qu√© Eliminar FormateadorMensajes Separado?**
- üîÑ **Simplificaci√≥n**: Formateo espec√≠fico por tipo de comando
- üìù **Personalizaci√≥n**: Mensajes adaptados a cada funcionalidad
- üéì **Enfoque**: Concentraci√≥n en conceptos de POO principales
- ‚ö° **Rendimiento**: Menos llamadas a m√©todos externos

---

## üîß Configuraci√≥n y Personalizaci√≥n

### **Archivo pom.xml**
```xml
<dependencies>
    <dependency>
        <groupId>net.dv8tion</groupId>
        <artifactId>JDA</artifactId>
        <version>5.0.0-beta.18</version>
    </dependency>
</dependencies>
```

### **Variables de Configuraci√≥n**
```java
// En BotEducativo.java
private static final String VERSION = "1.0.0";
private static final String PREFIJO_COMANDO = "!";
private final Map<String, Comando> comandos = new HashMap<>();
```

### **Personalizaci√≥n F√°cil**
- üé® **Mensajes**: Modificar directamente en cada comando unificado
- üìù **Prefijo**: Cambiar `PREFIJO_COMANDO` en `BotEducativo`
- üéØ **Puntos**: Ajustar en `ComandoTareas` y `ComandoSistema`
- üîß **Subcomandos**: Agregar casos al switch en comandos unificados
- ‚öôÔ∏è **Funcionalidades**: Expandir comandos existentes sin crear archivos nuevos

---

**üèóÔ∏è Esta estructura unificada demuestra una evoluci√≥n natural de POO con patrones de dise√±o modernos, eliminando duplicaci√≥n y mejorando la organizaci√≥n funcional.**

Para entender c√≥mo usar el sistema, revisa la [Gu√≠a de Uso](GUIA_USO.md).
